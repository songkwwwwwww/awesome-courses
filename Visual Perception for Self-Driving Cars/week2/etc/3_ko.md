지금까지, 우리는 이미지의 기능 위치를 추출하는 방법과 이러한 기능의 지역 이웃에서 설명자를 추출하는 방법을 배웠습니다. 이 비디오는 자율주행 기능 매칭에서 컴퓨터 비전 애플리케이션에 대한 기능을 사용하는 마지막 단계에 대해 가르쳐 줄 것입니다. 특히, 우리는 거리 함수를 기반으로 기능을 일치시키는 방법을 다룰 것이며, 무차별 대입 매칭을 간단하지만 강력한 기능 매칭 알고리즘으로 설명할 것입니다. 하지만 먼저, 다양한 인식 작업에 기능을 어떻게 사용하려고 하는지 상기시켜 봅시다. 먼저, 우리는 이미지의 특징, 이미지의 독특한 점을 식별합니다. 둘째, 우리는 이웃의 각 기능에 대한 설명자를 연결합니다. 마지막으로, 우리는 두 개 이상의 이미지의 기능을 일치시키기 위해 설명자를 사용합니다. 그 후, 상태 추정, 시각적 거리 측정 및 물체 감지를 포함한 다양한 응용 분야에 일치하는 기능을 사용할 수 있습니다. 그러나 잘못된 일치가 너무 자주 제공되면 이러한 응용 프로그램은 치명적인 실패에 취약하기 때문에 일치 항목을 올바르게 식별하는 것이 필수적입니다. 결과적으로, 기능 매칭은 자율주행 자동차를 위한 강력한 인식 방법에 중요한 역할을 한다. 다음은 기능 매칭 문제의 예입니다. 기능과 이미지 1의 설명자를 감안할 때, 우리는 이미지 2의 기능에 가장 적합한 것을 찾고 싶습니다. 그렇다면 우리는 이 문제를 어떻게 해결할 수 있을까요? 매칭 문제에 대한 가장 간단한 해결책은 무차별 대입 특징 매칭이라고 하며, 다음과 같이 설명된다. 먼저, 두 피처 fi와 fj의 설명자를 비교하고 그들 사이의 거리를 정의하는 거리 함수 d를 정의하십시오. 두 설명자가 서로 더 비슷할수록, 그들 사이의 거리가 작아진다. 둘째, 이미지 1의 모든 기능 fi에 대해 거리 함수 d를 적용하여 이미지 2의 모든 기능 fj로 거리를 계산합니다. 마지막으로, 우리는 이미지 1의 기능 fi까지의 최소 거리를 가진 이미지 2에서 fc를 호출할 기능을 일치로 반환할 것입니다. 이 기능은 가장 가까운 이웃으로 알려져 있으며, 설명자 공간에서 원본과 가장 가까운 기능이다. 설명자를 비교하는 데 사용되는 가장 일반적인 거리 기능은 제곱 거리 또는 SSD의 합이다. 두 설명자 간의 변화를 이차적으로 처벌하여 설명자의 큰 변형에 민감하지만 더 작은 변형에는 민감하지 않습니다. 절대 차이의 합이나 해밍 거리와 같은 다른 거리 기능도 실행 가능한 대안이다. 절대 차이의 합은 모든 변형을 동등하게 처벌하는 반면 해밍 거리는 모든 설명자 요소가 이진 값인 이진 기능에 사용된다. 우리는 우리의 예를 따르기 위해 SSD 거리 기능을 사용할 것이다. 우리의 매칭 기술과 거리 선택은 정말 간단하다. 하지만 우리가 제안한 가장 가까운 이웃 매칭 기술에 무엇이 잘못될 수 있다고 생각하나요? 우리의 첫 번째 사례를 살펴보고 우리의 무차별 대입 matcher가 실제로 어떻게 작동하는지 봅시다. 노란색 경계 상자 안의 특징을 고려해 보세요. 단순함을 위해, 이 기능에는 f1이라고 부를 4차원 설명자가 있습니다. F1과 f2에 라벨을 붙일 이미지 2의 첫 번째 기능 사이의 거리를 계산해 봅시다. 우리는 제곱 차이 또는 SSD 값의 합계 9를 얻습니다. 그런 다음 이미지 2의 f1과 두 번째 기능 사이의 거리를 계산하여 f3에 라벨을 붙일 것입니다. 여기서, 우리는 652의 SSD를 얻는다. 이제 두 번째 이미지의 다른 모든 기능에 대해 이 과정을 반복하고 다른 모든 거리가 첫 번째 거리에 비해 비슷하게 크다는 것을 알 수 있습니다. 따라서 우리는 f1까지의 거리가 가장 낮기 때문에 기능 f2를 우리의 일치로 선택합니다. 시각적으로, 우리의 무차별 대입 접근 방식은 효과가 있는 것으로 보인다. 인간으로서, 우리는 이미지의 기능 f1이 실제로 이미지 2의 피처 f2와 같은 관심 지점이라는 것을 즉시 알 수 있다. 이제 기능 탐지기가 이미지 1의 기능과 일치하려고 시도하는 두 번째 경우를 고려하여 이미지 2에 해당 기능이 없습니다. 우리의 기능 탐지기가 이 상황에 직면했을 때 무차별 대입 접근 방식이 무엇을 할 것인지 살펴봅시다. 이전과 같은 절차에 따라, 우리는 이미지 1의 기능 f1의 설명자와 이미지 2의 모든 기능 사이에서 SSD를 계산합니다. F2와 f3이 f1의 가장 가까운 이웃이고 f2가 가장 낮은 점수를 가지고 있다고 가정하십시오. 441이지만, 여전히 원본 이미지의 f1 기능 설명자와 다소 다르다. 결과적으로, f2는 우리의 최고의 경기로 반환될 것이다. 분명히, 이것은 옳지 않다. 기능 f1은 장면의 기능 f2와 같은 관심 지점이 아니기 때문이다. 그렇다면 우리는 이 문제를 어떻게 해결할 수 있을까요? 우리는 경기 수락에 대한 거리 임계값 델타를 설정하여 이 문제를 해결할 수 있다. 이것은 델타에서 f1까지의 거리가 큰 이미지 2의 모든 기능이 이미지 2의 모든 기능 중에서 f1까지의 최소 거리가 있더라도 일치하는 것으로 간주되지 않는다는 것을 의미합니다. 이제 무차별 대입 매칭 알고리즘을 임계값으로 업데이트합시다. 우리는 보통 당면한 응용 프로그램과 우리가 사용하고 있는 설명자에 따라 델타를 경험적으로 정의합니다. 다시 한번, 우리는 두 기능 설명자의 유사성을 정량화하기 위해 거리 함수를 정의합니다. 우리는 또한 허용 가능한 경기를 위해 최대 거리 임계값 델타를 수정합니다. 그런 다음 이미지 1의 모든 기능에 대해 이미지 2의 각 기능까지의 거리를 계산하고 가장 짧은 거리 또는 가장 가까운 이웃을 가장 가능성이 높은 것으로 저장합니다. 무차별 대입 매칭은 우리가 일치시키고자 하는 기능의 수가 합리적이지만 이차 계산 복잡성이 있어 기능의 수가 증가함에 따라 부적합할 때 적합합니다. 대규모 기능 세트의 경우, k-d 트리와 같은 특수 데이터 구조는 계산 시간을 향상시키는 데 사용됩니다. 무차별 대입과 k-d 트리 기반 매처는 모두 OpenCV의 일부로 구현되어 쉽게 사용해 볼 수 있습니다. 이 슬라이드 하단에 표시된 링크를 따라가세요. 다시 말씀드리지만, 검토를 위해 이 강의 슬라이드를 다운로드할 수 있습니다. 지금까지는 기능 감지, 설명 및 매칭에 대해 훨씬 더 잘 이해해야 합니다. 이 세 단계는 시각적 거리 측정 및 물체 감지와 같은 다양한 자율주행 애플리케이션에 기능을 사용하는 데 필요합니다. 우리의 무차별 대입 matcher는 꽤 깊지만, 여전히 완벽과는 거리가 멀다. 우리는 안전하고 신뢰할 수 있는 자율주행 자동차 인식을 만들기 위해 정확한 결과가 정말로 필요하다. 그래서 다음 수업에서, 우리는 종종 잘못된 결과로 이어지는 번거롭고 모호한 경기를 수용하기 위해 무차별 대입 matcher를 개선하는 방법을 배울 것입니다. 다음 비디오에서 보자.