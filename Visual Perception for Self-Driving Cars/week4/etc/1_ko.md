안녕하세요, 자율주행 과정에 대한 시각적 인식 4주차에 오신 것을 환영합니다. 이번 주에, 우리는 자율주행 자동차 인식 스택의 핵심 요구 사항인 물체 감지에 뛰어들 것입니다. 물체 감지는 차량, 보행자, 표지판 및 조명의 위치를 식별하는 데 필요한 최상위 모듈이므로 자동차는 어디서 어떻게 운전할 수 있는지 알 수 있습니다. 이번 주에, 우리는 2D 물체 감지 문제, ConvNets를 적용하여 해결하는 방법, 그리고 2D 물체 감지 문제가 왜 어려운지 자세히 정의할 것입니다. 그런 다음 물체 감지가 2D 물체 추적 문제에 대한 입력으로 어떻게 사용되는지, 그리고 자율주행 자동차의 맥락에서 추적 작업을 수행하는 방법을 설명할 것입니다. 이 수업은 물체 감지 문제를 2D로 공식화할 것이다. 또한 현장에서 연구원들이 설정한 표준 성능 지표를 사용하여 2D 물체 검출기를 평가하는 방법을 배우게 될 것입니다. 시작하자. 2D 물체 감지의 역사는 2001년 폴 비올라와 마이클 존스가 얼굴 탐지를 위한 매우 효율적인 알고리즘을 발명했을 때 시작된다. 현재 비올라라고 불리는 이 알고리즘인 존스 객체 탐지 프레임워크는 간단한 웹캠에서 신뢰할 수 있는 실시간 2D 물체 감지를 제공하는 최초의 물체 감지 프레임워크였다. 물체 감지의 다음 큰 돌파구는 4년 후 Navneet Dalal과 Bill Triggs가 지향 그라데이션 기능 설명자의 히스토그램을 공식화했을 때 일어났다. 그들의 알고리즘은 2D 보행자 탐지 문제에 적용되었고, 당시 제안된 다른 모든 방법을 능가했다. 달랄, 트릭스 알고리즘은 토론토 대학교 컴퓨터 과학부의 알렉스 크리제예프스키, Ilya Sutskever, Geoffrey Hinton이 AlexNet이라고 불리는 컨볼루션 신경망으로 컴퓨터 비전 세계를 흔들었을 때까지 차트 상단에 남아 있었다. AlexNet은 2012년에 2위를 차지한 알고리즘보다 넓은 차이로 ImageNet 대규모 시각적 인식 챌린지에서 우승했다. 2012년에, 그것은 도전에서 유일한 딥 러닝 기반 항목이었다. 하지만 그 이후로, 이 대회에서 우승한 모든 출품작은 최근 95%의 인간 인식률을 능가하는 컨볼루션 신경망을 기반으로 한다. 이 성능은 2D 물체 인식에서 2D 물체 감지로 확장되었으며, 현재 검출기는 거의 독점적으로 컨볼루션 신경망을 기반으로 한다. 물체 감지 및 자율주행 자동차에 ConvNets를 사용하는 방법을 살펴보기 전에, 일반적인 2D 물체 감지 문제를 공식화합시다. 2D 이미지의 입력이 주어지면, 경계 상자로 정의된 위치와 장면의 모든 객체의 클래스를 추정해야 합니다. 보통, 우리는 지원서와 관련된 수업을 선택합니다. 자율주행 자동차의 경우, 우리는 보통 역동적인 객체 클래스, 즉 현장을 통과하는 것에 가장 관심이 있다. 여기에는 하위 클래스의 차량, 보행자 및 자전거 운전자가 포함됩니다. 2D 물체 감지 문제는 사소하지 않다. 우리가 추정해야 하는 물체의 범위가 이미지 공간에서 항상 완전히 관찰되는 것은 아니다. 예를 들어, 배경 물체는 보통 전경 물체에 의해 가려진다. 이것은 우리가 물체의 범위를 적절하게 감지하기 위해 환각할 수 있도록 사용하는 모든 알고리즘이 필요하다. 게다가, 이미지의 가장자리 근처에 있는 물체는 보통 잘린다. 이 현상은 예상 경계 상자의 크기가 물체가 얼마나 잘렸는지에 따라 달라지는 경계 상자 크기에 큰 변동성을 만들어낸다. 2D 물체 감지 알고리즘이 직면한 또 다른 문제는 규모의 문제이다. 물체는 검열에서 더 멀어질 때 매우 작게 보이는 경향이 있다. 우리의 알고리즘은 변수 규모로 이러한 객체의 클래스를 결정할 것으로 예상된다. 마지막으로, 우리의 알고리즘은 조명 변경도 처리할 수 있어야 한다. 이것은 밝은 태양에서 야간 운전으로의 전체 이미지 조명 변화와 반사, 그림자, 강수량 및 기타 성가신 효과로 인한 부분적인 변화에 영향을 받을 수 있는 자율주행 자동차의 맥락에서 특히 중요합니다. 이제 물체 감지가 무엇인지 직관적으로 이해했으니, 문제를 수학적으로 공식화합시다. 객체 감지는 함수 추정 문제로 정의될 수 있다. 입력 이미지 x를 감안할 때, 우리는 세타에서 상자의 왼쪽 상단 좌표, xmin과 ymin, 상자의 오른쪽 하단 모서리 좌표, xmax와 ymax, 클래스 점수 Sclass1에서 Sclassk를 포함하는 출력 벡터를 생성하는 x의 함수 f를 찾고 싶습니다. Sclassi는 알고리즘이 객체가 클래스 i에 속한다는 것을 얼마나 확신하는지 지정하고, i는 1에서 k까지 다양하며, 여기서 k는 관심 클래스 수입니다. 이 기능을 추정할 방법을 생각할 수 있나요? 우리가 지난 주에 설명한 컨볼루션 신경망은 이런 종류의 기능을 추정하는 훌륭한 도구이다. 객체 감지의 경우, 입력 데이터는 2D 그리드에 정의되므로 ConvNets를 선택한 함수 추정기로 사용하여 이 작업을 수행합니다. 다음 수업에서 ConvNets로 2D 물체 감지를 수행하는 방법에 대해 논의할 것입니다. 하지만 먼저, 우리는 알고리즘의 성능을 측정하는 방법을 알아내야 한다. 빨간색의 2D 물체 검출기의 출력을 감안할 때, 우리는 그것이 보통 인간이 표시하는 실제 출력에 얼마나 잘 맞는지 비교할 수 있기를 원합니다. 우리는 진정한 출력을 우리의 지상 진실 경계 상자라고 부른다. 평가 프로세스의 첫 번째 단계는 Intersection-Over-Union 메트릭 또는 IOU를 통해 검출기 현지화 출력을 지상 진실 상자와 비교하는 것입니다. IOU는 연합의 영역으로 나눈 두 다각형의 교차점 영역으로 정의된다. 그러나, 교차로 연봉을 계산하는 것은 수업 점수를 고려하지 않는다. 수업 점수를 설명하기 위해, 우리는 진정한 긍정적인 점을 정의한다. 진정한 긍정은 지상 진실 경계 상자가 있는 미리 정의된 임계값보다 큰 IOU를 가진 출력 경계 상자이다. 또한, 그 출력 상자의 클래스는 해당 지상 진실의 클래스와 일치해야 한다. 그것은 2D 탐지기가 올바른 클래스에 가장 높은 학급 점수를 주고, 점수 임계값보다 큰 점수를 가져야 한다는 것을 의미합니다. 반면에, 오탐은 점수 임계값보다 큰 점수를 가진 출력 상자이지만, 모든 지상 진실 경계 상자가 있는 IOU 임계값보다 적은 IOU이다. 이것은 점수 임계값을 적용한 후 감지된 물체의 총 수에서 실제 양성 수를 뺀 것으로 쉽게 계산할 수 있다. 우리가 추정하고 싶은 최종 기본 수량은 거짓 네거티브의 수이다. 거짓 네거티브는 IOU를 통해 그들과 관련된 탐지가 없는 지상 진실 경계 상자이다. 일단 우리가 진정한 양성, 오탐 및 거짓 네거티브를 결정하면; 우리는 다음에 따라 2D 물체 검출기의 정밀도와 리콜을 결정할 수 있습니다. 정확성은 진정한 긍정의 수와 거짓 긍정의 합으로 나눈 진정한 긍정의 수이다. 반면에 리콜은 지상 진리 물체의 총 수로 나눈 진정한 양성의 수이며, 이는 거짓 음성의 수에 추가된 진정한 양성의 수와 같다. 정밀도와 리콜을 결정하면, 정밀 리콜 곡선을 얻기 위해 객체 클래스 점수 임계값을 변경할 수 있으며, 마지막으로, 정밀도 리콜 곡선 아래의 영역으로 평균 정밀도를 결정합니다. 곡선 아래의 영역은 수치 통합을 사용하여 계산할 수 있지만, 일반적으로 0에서 1에 이르는 11개의 리콜 포인트에서 정밀도 값의 평균을 사용하여 근사치된다. 나는 이것들이 처음으로 이해해야 할 꽤 많은 개념이라는 것을 알고 있다. 하지만 곧 평가에서 파이썬에서 이러한 모든 메소드를 코딩하는 방법에 대한 단계별 연습 노트북을 통해 작업할 기회를 갖게 될 테니 걱정하지 마세요. 학습된 메트릭을 사용하여 2D 객체 감지 네트워크의 성능을 평가하는 방법에 대한 예를 살펴보겠습니다. 우리는 도로 장면에서 자동차만 감지하는 데 관심이 있다. 그것은 우리가 하나의 관심 클래스가 있다는 것을 의미하며, 따라서 고려해야 할 점수는 하나뿐이다. 우리는 인간이 라벨을 붙이고 녹색으로 표시된 자동차의 지상 진실 경계 상자를 받는다. 우리는 빨간색으로 표시된 감지 출력 경계 상자를 얻기 위해 confinet으로 이미지를 처리합니다. 네트워크가 대형 트럭의 전면을 자동차로 잘못 감지한다는 것을 알 수 있습니다. 점수를 보면, 우리는 우리의 confinet이 이 미스 탐지를 자동차라는 점에서 꽤 높은 점수를 주었다는 것을 알 수 있다. 이제 평균 정밀도를 사용하여 confinet의 성능을 평가해 봅시다. 첫 번째 단계는 모든 예상 경계 상자를 가져와 객체 클래스 점수에 따라 정렬하는 것입니다. 그런 다음 각 예측 상자와 해당 지상 진실 상자 사이의 IOU를 계산합니다. 상자가 접지 진실 상자와 교차하지 않으면, IOU는 0으로 설정됩니다. 먼저, 우리는 수업 점수 임계값을 말했다, 0.9라고 합시다. 이 임계값은 9보다 큰 점수를 반환하고 0.9 미만의 점수로 경계 상자를 제거하는 경우에만 네트워크 예측을 신뢰한다는 것을 의미합니다. 다음으로, 우리는 IOU 임계값을 설정하고, 이 경우 0.7을 사용하고 IOU가 0.7 미만인 나머지 예측을 제거할 것입니다. 이 경우, 나머지 두 예측 모두 0.7보다 큰 IOU를 가지고 있으므로, 우리는 아무것도 제거하지 않습니다. 이제 점수와 IOU 임계값을 모두 적용한 후 남은 경계 상자의 수로 진정한 긍정의 수를 계산할 수 있으며, 이 경우 2입니다. 점수 임계값 적용 후 남은 모든 상자도 IOU 임계값 적용 후에도 남아 있기 때문에 이 경우 오탐의 수는 0입니다. 마지막으로, 거짓 네거티브의 수는 점수와 IOU 임계값을 모두 적용한 후 그들과 관련된 탐지가 없는 지상 진실의 상자이다. 이 경우, 거짓 네거티브의 수는 두 개이다. 우리 신경망의 정밀도는 진정한 양성의 수를 오탐의 수와 합으로 나눈 것으로 계산된다. 이 경우, 우리는 거짓 긍정이 없다. 그래서 정밀도는 2보다 2가 1과 같다. 리콜을 계산하기 위해, 우리는 진정한 양성의 수를 지상 진실 경계 상자의 수로 나눕니다. 이는 거짓 네거티브의 수로 합산된 거짓 양성의 수와 같습니다. 이 경우의 리콜은 4개 이상이다. 이 경우 검출기는 고정밀 낮은 리콜 검출기이다. 이것은 탐지기가 장면에서 일부 물체를 놓쳤다는 것을 의미하지만, 물체를 감지할 때 카테고리 분류와 경계 상자 위치에서 실수를 거의 하지 않는다. 점수 임계값을 0.9에서 0.7로 낮출 때 탐지기의 성능이 어떻게 변하는지 봅시다. 모든 경계 상자는 0.7보다 큰 점수를 가지고 있으므로 점수 임계값을 통해 그 중 어느 것도 제거하지 않습니다. 그러나, 우리가 나머지 상자의 IOU를 검토할 때, 우리는 그들 중 두 개가 0.7 미만의 IOU를 가지고 있다는 것을 알 수 있다. 이 두 상자를 제거함으로써, 우리는 세 가지 진정한 긍정적인 면을 얻는다. 오탐의 수를 계산하려면, 점수 임계값을 적용한 후 IOU 임계값을 적용하기 전에 얼마나 많은 탐지가 남아 있는지 살펴볼 필요가 있다. 이 경우, 거짓 긍정의 수는 두 개이다. 마지막으로, 우리는 IOU와 점수 임계값을 모두 적용한 후 관련 탐지 없이 남아 있는 지상 진실 경계 상자의 수를 살펴보고 거짓 네거티브의 수로 얻습니다. 점수 임계값을 1에서 0.6로 낮춘 후 정밀도가 떨어졌고, 리콜은 0.5에서 0.75로 증가했습니다. 우리는 점수 임계값을 낮추는 효과가 장면에서 더 많은 물체를 감지하는 비용으로 덜 정확한 감지 결과라고 결론지을 수 있다. 이 과정을 계속하고 점수 임계값을 0.01 감소로 추정하면 다음 표에 도달합니다. 그런 다음 y축의 정밀도 값과 x축의 리콜 값을 사용하여 정밀 리콜 곡선을 플로팅합니다. 우리는 또한 플롯의 첫 번째로 1과 0의 정밀 리콜 포인트를 추가하고, 플롯의 마지막 포인트로 0을 추가한다는 점에 유의하십시오. 이를 통해 0.01 리콜 단위로 0에서 1 사이의 11개의 리콜 포인트를 사용하여 P-R 커브 아래의 영역을 계산하여 평균 정밀도를 근사화할 수 있습니다. 이 평균을 계산하면 자동차 탐지기의 경우 0.75의 AP가 생성됩니다. 검출기의 평균 정밀도 값은 모든 점수 임계값에 대한 평균 성능으로 생각할 수 있으며, 이러한 탐지를 생성한 정확한 점수 임계값을 고려하지 않고도 검출기의 성능을 객관적으로 비교할 수 있습니다. 이 비디오에서는 2D 물체 감지 문제를 공식화하는 방법과 평균 정밀 성능 메트릭을 사용하여 2D 객체 검출기 성능을 평가하는 방법을 배웠습니다. 다음 수업에서는 자율주행 자동차를 위한 2D 물체 검출기로 confinet을 사용하는 방법을 배우게 될 것입니다. 그때 보자.